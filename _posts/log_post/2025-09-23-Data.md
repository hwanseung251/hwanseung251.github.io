---
layout: post
title: '기존 데이터셋 한계 파악과 신규 데이터 구축 필요성'
date: 2025-09-23 23:54 +0800
logs: [WishEasy]
toc: True
---

## 개발 초기의 잘못된 전제

프로젝트 기획 단계에서 데이터를 찾아보면서 직접 불러와보진 않고 설명만 확인하며 역 안내 서비스 구현에 충분한 데이터가 존재한다라고 판단했다. 
하지만 기획에서 데이터 유무를 먼저 검증하지 않은 것은 큰 실수였다.

실제 API로 불러와서 탐색하고 어떻게 구현할지 구체적으로 설계하지 못해 이런 상황이 발생했다.

이 경험을 통해 기획 단계에서 데이터 가용성 검증은 절대적이라는 것을 뼈저리게 느꼈다...

## 데이터 확인

사용 예정이었던 데이터를 API로 직접 확인한 결과, 가장 먼저 눈에 띈 문제점은 모든 지하철 호선의 정보가 완전하게 포함되어 있지 않다는 점이었다. 일부 구간에서는 1~8호선만 제공되거나, 같은 호선 내에서도 몇몇 역의 데이터만 존재하는 경우가 있었다. 이는 해당 회사가 운영하는 특정 호선 범위 내에서만 데이터가 제공되는 구조로 보였다.

또다른 문제점은 아래 표처럼 역 내 동선 안내를 하기엔 턱없이 부족한 상태였다.

| 데이터셋      | 기대한 정보               | 실제 제공 정보            | 문제                           |
| --------- | -------------------- | ------------------- | ---------------------------- |
| 에스컬레이터 정보 | 층간 이동, 방향, 위치, 구조 정보 | 위치, 운영 상태, 출발/도착 층  | 방향성 및 구조 관점 부족 / 호선마다 정보 불일치 |
| 최단경로 이동정보 | 역사 내 이동 동선           | 역과 역 사이 경로          | 안내 목적과 무관                    |
| 역사 건축 정보  | 상세 구조, 연결 관계         | 승강장 유형, 면적, 준공 연도 등 | 연결구조 파악 불가                   |


## 역 안내 서비스 구현 관점에서 구체적으로 데이터 적합성 검증

데이터를 구축하고 기능을 구현하는 담당이다보니 여러 방면으로 `EDA`를 진행했고 원하는 기능 구현이 불가능하다라는 결론이 나왔다. 하지만 팀원들 중에서는 기존에 있는걸로 될거같은데? 라는 의견이 좀 있었다.

맡은 분야이니만큼, 그냥 안될거같다 보단 기존에 있는걸로 보완 시도 해결 시도를 하고 안되더라도 이유를 찾고 어떻게 해결할지 계획을 정리한다음 팀원들에게 구체적으로 공유하는 것이 좋은 선택이라고 생각이 들었다.

1. 무엇을 구현해야 하는지, 
2. 필요한 데이터는 무엇인지, 
3. 현재 어떤 데이터가 있는지, 
4. 현재 데이터로 구현이 가능한지, 안된다면 한계는 무엇인지
각 단계로 정리해보았다.


### 1. 구현하고자 하는 것
지하철 이용자가
```
출구 → 대합실 → 승강장
OR
환승 승강장 → 환승 통로 → 승강장
```
으로 이동할 때
- 역 내 이동 동선 안내
- 에스컬레이터 우선 경로 안내
- 복잡한 역 구조에서도 최적 이동 경로 제공

을 목표로 한다.

즉, 역 내 구조를 정확히 이해하고 사용자에게 안내할 수 있어야 한다.


### 2. 필요한 데이터
역 안내를 위해 필요한 핵심 데이터 요구조건
| 항목      | 요구되는 정보                    |
| ------- | -------------------------- |
| 역 구조    | 출구-대합실-승강장 관계 및 연결 구조      |
| 층 정보    | 각 시설의 정확한 층 위치             |
| 이동기구 정보 | 에스컬레이터/엘리베이터 방향, 위치, 연결 관계 |
| 환승 정보   | 환승 통로 유형, 연결 구간            |
| 활용 가능성  | 모든 호선 & 모든 역에 대한 통일된 형식    |


### 3. 현재 보유한 데이터 
| 데이터셋         | 보유 정보                  | 문제점                   |
| ------------ | ---------------------- | --------------------- |
| 에스컬레이터 운영 정보 | 위치, 운영 방향(층→층)         | 층 정보 부정확, 구조 연결 정보 없음 |
| 역사건축 정보      | 승강장 유형(섬식/상대식), 면적, 층수 | 연결 정보 부재              |
| 빠른하차 정보      | 출구/승강장 방면 정보           | 이동기구 연결 정보는 있으나 제한적   |
| 최단경로 이동정보    | 역 간 최단거리               | 역 내부 구조와 무관           |


### 4. 에스컬레이터 기반 Bottom-up 역 구조 추론 접근 정리
역 안내 시스템 구현을 위해서는
`출구–대합실–승강장 간의 구조적 연결 정보`가 필수적이다.

그러나 보유한 데이터에는 **정확한 역 내부 구조 데이터**가 없다는 것인데, 현재 상황에서 구현이 가능할지 시도를 했다.

현재 확보 가능한 데이터 중
가장 구조를 간접적으로 유추 가능한 데이터인

`에스컬레이터 운영 데이터`

를 중심으로 역 구조를 추론하여 안내해보고자 했다.

### 4-1. 에스컬레이터 데이터로부터 확보 가능한 정보
| 번호 | 확보 정보                         | 의미         |
| -- | ----------------------------- | ---------- |
| 1  | 해당 역의 모든 에스컬레이터 목록            | 시설 전수 파악   |
| 2  | 각 에스컬레이터의 시작층/종료층             | 층간 연결 정보   |
| 3  | 각 에스컬레이터의 운영 구역(승강장 방면, 출구 등) | 간접적인 연결 관계 |

현재 보유한 데이터로 알 수 있는 정보를 정리해보니 안내를 하는데 있어 `애매한 부분(3가지)`을 구분할 수 있었다. 

### 4-2. 문제 도출 및 해결
`**문제 1: 섬식 승강장 에스컬레이터 공유 문제**`

![에스컬레이터]({{ assets/images/Data/에스컬레이터.png | relative_url }})

서울역 1호선은 섬식으로 남영 방면과 시청 방면에서는 에스컬레이터를 모두 이용할 수 있지만 각각 한쪽 방면으로만 태깅되어있다. 

→ 실제 구조처럼 안내하기 어려움 

해결 방법: 에스컬레이터, 빠른하차정보, 역사건축정보 데이터를 조인하여 해결. 

- 빠른하차정보와 역사건축정보를 역, 방면을 축으로 조인.
  - 섬식/상대식 여부 병합

- 빠른하차정보와 에스컬레이터를 승강기 일련번호를 축으로 조인.
  - 방면 정보 + 승강기 일련번호 매칭

![merge]({{ assets/images/Data/merge.png | relative_url }})


`**문제 2: 에스컬레이터 단방향 운영의 활용 한계**`

문제 상세

- 에스컬레이터는 상행/하행 단방향 운영
- 시작층/종료층 정보만으로는 **그 층의 역할(대합실인지 승강장인지)**을 모름
- 즉, 들어가는 경로인지 나가는 경로인지 판단 불가
  
>예: 지하1층↔지상1층
>이 경로의 방향성은 층 역할에 따라 inbound/outbound가 달라짐

해결 방법: 승강장의 층 정보를 활용해 inbound/ outbound 판정

- 역사건축정보에서 승강장 층수 확보
- 층 역할 + 방향성 결합 → 유입/유출 판단 가능

  → 한계: 승강장과 연결된 에스컬레이터만 판단 가능


`**문제 3: 에스컬레이터 연결 층의 부정확성**`

문제 상세
- 에스컬레이터 층수가 전체 역 기준으로 되어있지 않고 해당 호선 기준으로 되어있음
  - 예: 전체역에서 보면 2->4층 운영인데 2->3층 운영으로 표기
- 즉, 정확한 층 수로 안내 불가능

정확한 보정은 불가능 했고, 이 역시 정확한 층 수가 있는 승강장과 연결된 부분의 에스컬레이터 정보를 활용해서
탑승구에서 내려서 에스컬레이터가 이용이 가능하다/불가능하다로 판단만 가능하도록 매핑해주었다.

## 한계점
그럼 이제 어떤정보를 알 수 있냐?
1. `승강장과 이어진 에스컬레이터가 있다면` 승강장으로 들어가거나 나갈 수 있는걸 안내할수있다. 
2. 출구를 기준으로도 에스컬레이터가 있다면 역으로 들어가거나 나갈 수 있는걸 안내할 수 있다.
이 두가지 안내가 가능하다.

하지만 이건 하고자 하는 안내에 아주 일부분에 불과하다. 역은 기본적으로 출구, 대합실, 승강장으로 크게 구분되어있고 환승을하는 상황이라면 "승강장 - 환승통로 - (대합실) - 승강장" 이렇게 이동할 수 있겠다. 근데 이것또한 역마다 구조가 다 다르다. 

이 과정을 진행하면서 지하철 역 구조가 정말 다양하다는 점을 실감했다.
대합실이 여러 개인 경우, 승강장이 상층에 위치한 경우, 대합실과 승강장 간 층 이동이 없는 경우, 환승통로가 승강장↔승강장, 대합실↔승강장, 대합실↔대합실로 이어지는 등 패턴이 매우 다양했다.
결국 이러한 복잡한 형태를 정확히 다루기 위해서는 역 간의 연결 구조를 체계적으로 표현할 수 있는 구조적 데이터 설계가 필요하다는 결론에 이르렀다.
어쩌면 해보지 않아도 예상할 수 있었던 부분이지만, 직접 작업을 진행하면서 그 복잡성을 체감하며 내린 스스로의 한계점이었다.


## 결론
그래서 나는 데이터를 직접 구축하기로 결정했다.
임시로 랜덤 데이터를 생성할 수도 있었지만, 그렇게 하면 실제 문제 상황과는 거리가 있었다.
비록 완전히 현실과 동일한 수준은 아니더라도, 현실에 최대한 근접한 구조를 가진 데이터를 직접 구축함으로써
프로젝트 진행 중에 실제 환경과 유사한 문제를 마주하고 이를 해결하는 과정을 경험하고 싶었다.

데이터 구축에 앞서, 어떻게 기능을 구현할 것인지, 그러려면 어떤 데이터가 필요한지를
명확히 정의해야 했다.
이 부분에 대한 구체적인 내용은 다음 포스팅에서 자세히 정리할 예정이다.




