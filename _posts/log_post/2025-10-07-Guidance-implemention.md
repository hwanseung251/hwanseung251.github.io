---
layout: post
title: '안내 구현'
date: 2025-10-07 20:11 +0800
logs: [WishEasy]
toc: True
---
1. 지하철 이용안내도를 보면 크게 출구 대합실 승강장으로 공간을 구분할 수 있다.
2. 더 작게 나누면 몇번 출구인지 몇호선 대합실인지 몇호선 어디 방면 승강장인지 구분할 수 있다.
3. 여기서 더 정확한 안내를 위해서 더 자세하게 나누면 각 대합실과 승강장이 이어지는 첫번째 통로, 두번째 통로 등 으로 모든 구조를 나눌 수 있다.

정확하고 서비스가 가능한 안내를 위해선 3번 구조로 나눠야한다. 하지만 현실적으로 각 구조를 사용자가 인지할 수 있는 명칭으로 나누려면 지하철 이용안내도 그림만 보고는 어렵고 직접 지하철역을 다니면서 그 특징을 파악하고 구조를 나눠야한다.

지금 데이터를 만드는 입장에서 현실적으로 어려움이 있기때문에 2번 구조 수준으로 나누어 안내 구현을 했다

## 안내 기능 설계
1. 최단경로 API를 활용해 사용자의 출발과 환승, 도착역을 파악한다.
2. 파악한 각 역에서의 노드와 엣지데이터를 활용해 BFS 알고리즘으로 경로를 파악한다.

## 데이터 설계
안내 기능은 경로 탐색이 핵심이므로 노드-엣지 그래프 구조로 설계하고자 했다

1. 노드데이터
    - column: line, station, node_id, node_name, floor, type
    - value: 2호선, 강변, 강변_001, 2호선 대합실, 지상 1층, 대합실 
2. 엣지데이터
    - column: line, station, source, target, relation, is_escalator, escalator, out_of_order, edge_key
    - value: 2호선, 강변, 강변_001, 강변_002, 2호선 대합실에서 계단/도보를 이용하여 2호선 구의 방면 승강장으로 이동하세요., Null, 0, 0, 강변_001->강변_002

### 데이터 요구사항 정의
- 노드데이터
  - line: 지하철역의 운영되는 호선을 '2호선'이런 형태로 기입. 환승역일 땐 '2호선, 6호선' 이렇게 기입. 
    - line 컬럼은 해당 노드가 속한 역 구조의 맥락을 파악하기 위한 보조 정보로만 사용되며,
주요 목적은 ‘해당 노드가 어떤 역의 어떤 구조적 위치를 나타내는가’를 표현하는 데 있다.
따라서 노선 정보를 별도 테이블로 정규화할 경우,
핵심 구조 식별(노드 단위 구조 분석)보다는 관계 관리 복잡도가 증가하게 되므로
‘2호선, 6호선’과 같이 문자열 형태로 복수 노선을 병기하는 비정규화 방식을 채택하였다.
이는 기능 목적상 노선 식별보다는 역 내부 구조 이해와 안내 경로 탐색 정확도에 초점을 두었기 때문이다.
  - station: 지하철역 명을 '강변' 이런 형태로 기입.
  - node_id: 각 노드를 구분할 id. 각 역마다의 노드 id를 구별하기 위해 '강변_001' 형태로 기입.